<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="adminPofile.css">
</head>
<body style="background-color: white">


<div class="container main" style="margin-top: 20px">
    <h1>Welcome Admin</h1>
    <!-- Nav tabs -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link active" id="home-tab" data-toggle="tab" href="#EventManager" role="tab" aria-controls="Event" aria-selected="true">Event Manager</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="profile-tab" data-toggle="tab" href="#Event" role="tab" aria-controls="profile" aria-selected="false">Event</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="messages-tab" data-toggle="tab" href="#enquiry" role="tab" aria-controls="enquiry" aria-selected="false">Enquiry by Event Mangager</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="settings-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="faq" aria-selected="false">Profile</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="carousel-tab" data-toggle="tab" href="#carousel" role="tab" aria-controls="faq" aria-selected="false">Carousel</a>
        </li>
        <li class="nav-item" style="margin-right: 0; margin-left: auto">
            <a class="nav-link" id="logout-tab"  href="/index.html"  aria-controls="faq" aria-selected="false">Logout</a>
        </li>
    </ul>
    <!-- Tab panes -->
    <div class="tab-content">
        <div class="tab-pane active" id="EventManager" role="tabpanel" aria-labelledby="settings-tab" >
            <div class="content">
            <form  method="post" id="EMform">
        <table id = "EMTable" border="2px" cellpadding="5px">
            <tbody id = "EMBody">
            <tr>
                <th></th>
                <th>Name</th>
                <th>Age</th>
                <th>Address</th>
                <th>DOB</th>
            </tr>
            </tbody>
        </table>
                <br>
            <button class="btn btn-success" type="button" onclick="onshowDiv()">Add</button>
                <button class="btn btn-danger" formmethod="post" formaction="/delEM" type="submit" disabled id="delBtn">Delete</button>
                <button class="btn btn-info"  formmethod="post" formaction="/updateEM" type="submit" disabled id="updBtn" onclick="onUpdateEM()">Update</button>
            </form>
                <hr>
                <div class="addEM" style="display: none" id ="addEm" >
                <form style="background-color: white; margin-top: 5%; border-radius: 20px" class="container" action="/addEventManager" method="post">
                <div class="form-row" >
                    <div class="form-group col-md-6">
                        <label for="fName">First Name</label>
                        <input type="text" class="form-control" id="fName" placeholder="First Name" name="fname">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="lName">Last Name</label>
                        <input type="text" class="form-control" id="lName" placeholder="Last Name" name="lname">
                    </div>
                </div>
                <div class="form-row" >
                    <div class="form-group col-md-4">
                        <label for="dob">Date of Birth</label>
                        <input type="date" class="form-control" id="dob" placeholder="dd-mm-yyyy" name="dob">
                    </div>
                    <div class="form-group col-md-4">
                        <label for="age">Age</label>
                        <input type="number" class="form-control" id="age" placeholder="Age" name="age">
                    </div>
                    <div class="form-group col-md-4">
                        <label for="gender">Gender</label>
                        <br>
                        <select name="genderSelect" id="gender" class="form-control" >
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>

                        </select>
                    </div>
                </div>
                <div class="form-row" >
                    <div class="form-group col-md-6">
                        <label for="inputEmail4">Email</label>
                        <input type="email" class="form-control" id="inputEmail4" placeholder="Email" name="email" >
                    </div>
                    <div class="form-group col-md-6">
                        <label for="inputPassword4">Password</label>
                        <input type="password" class="form-control" id="inputPassword4" placeholder="Password" name="password">
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputAddress">Address</label>
                    <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St" name="address">
                </div>

                <button type="submit" class="btn btn-primary" style="margin-bottom: 10px">Add</button>
                </form>
            </div>
                <div class="upDateEM" style="display: none" id="updEM">
                    <form method="post" action="/updateEventManager" id="UpdateEM">
                        <div class="form-row" >
                            <div class="form-group col-md-6">
                                <label for="fNameU">First Name</label>
                                <input type="text" class="form-control" id="fNameU" placeholder="First Name" name="fnameU">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="lNameU">Last Name</label>
                                <input type="text" class="form-control" id="lNameU" placeholder="Last Name" name="lnameU">
                            </div>
                        </div>
                        <div class="form-row" >
                            <div class="form-group col-md-4">
                                <label for="dobU">Date of Birth</label>
                                <input type="date" class="form-control" id="dobU" placeholder="dd-mm-yyyy" name="dobU">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="ageU">Age</label>
                                <input type="number" class="form-control" id="ageU" placeholder="Age" name="ageU">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="genderU">Gender</label>
                                <br>
                                <select name="genderSelect" id="genderU" class="form-control" >
                                    <option value="female">Female</option>
                                    <option value="male">Male</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row" >
                            <div class="form-group col-md-6">
                                <label for="inputEmail4U">Email</label>
                                <input type="email" class="form-control" id="inputEmail4U" placeholder="Email" name="emailU" >
                            </div>
                            <div class="form-group col-md-6">
                                <label for="inputPassword4U">Password</label>
                                <input type="text" class="form-control" id="inputPassword4U" placeholder="Password" name="passwordU">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputAddressU">Address</label>
                            <input type="text" class="form-control" id="inputAddressU" placeholder="1234 Main St" name="addressU">
                        </div>
                        <input type="hidden" id = "IdHidden" name="IdHidden">
                        <button type="submit" class="btn btn-primary" style="margin-bottom: 10px">Update</button>
                    </form>
                </div>
        </div>
        </div>
        <div class="tab-pane " id="Event" role="tabpanel" aria-labelledby="home-tab">
            <div>
            <h3 >Booked Events </h3>
                <div id="BookedEvents"></div>
            <table border="2px" id="BookedEventList">
                <tr>
                    <th>Customer Id</th>
                    <th>Event Name</th>
                    <th>Event Date</th>
                    <th>Event Time</th>
                    <th>No. of Guest</th>
                </tr>
            </table>

            </div>
            <hr>
            <div>
            <h3>Events List</h3>
                <form action="" id="EventForm" >
                <table border="2px" id="EventList">
                    <tr>
                        <th></th>
                        <th>Serial Number</th>
                        <th>Event Name</th>
                        <th>Image</th>
                        <th>Price/Guest</th>
                    </tr>
                </table>
                    <br>
                    <button class="btn btn-success" type="button" onclick="onAddEvent()">Add</button>
                    <button class="btn btn-danger" formmethod="post"  formaction="/delEvent" type="submit" disabled id="delEventBtn">Delete</button>
                    <button class="btn btn-info"  formmethod="post" formaction="/updateEvent" type="submit" disabled id="updEventBtn" onclick="onshowEventUpdDiv()">Update</button>
                </form>
            </div>
            <hr>
            <div id="addEvent" style="display: none">
                <form style=" margin-top: 5%; border-radius: 20px" class="container" method="post" action="/AddEvent" enctype="multipart/form-data"  >

                    <div class="form-group">
                        <label for="EventName">Name of Event</label>
                        <input type="text" class="form-control" id="EventName" placeholder="Name of the event" name="EventName" >
                    </div>
                    <div class="form-group">
                        <label for="Description">Description of Event</label>
                        <textarea id="Description" name="Description" cols="110" rows="10"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="Location">Location of Event</label>
                        <input type="text" class="form-control" id="Location" placeholder="Location of the event" name="Location" >
                    </div>

                    <div class="form-row" >
                        <div class="form-group col-md-4">
                            <label for="files">Images:</label>
                            <input type="file" id="files" name="files" class="form-control" >
                        </div>
                        <div class="form-group col-md-4">
                            <label for="MaxGuest">Maximum Number of Guest</label>
                            <input type="number" class="form-control" id="MaxGuest" name="MaxGuest">
                        </div>
                        <div class="form-group col-md-4">
                            <label for="PricePerGuest">Per person Cost</label>
                            <input type="number" class="form-control" id="PricePerGuest" name="PricePerGuest">
                        </div>
                    </div>


                    <button type="submit" class="btn btn-primary" style="margin-bottom: 10px">Add</button>
                </form>
            </div>
            <div id="UpdateEvent" style="display: none;">
                <form style=" margin-top: 5%; border-radius: 20px" class="container" method="post" action="/updateEventShow" enctype="multipart/form-data">

                    <div class="form-group">
                        <label for="EventNameU">Name of Event</label>
                        <input type="text" class="form-control" id="EventNameU" placeholder="Name of the event" name="EventNameU" >
                    </div>
                    <div class="form-group">
                        <label for="DescriptionU">Description of Event</label>
                        <textarea id="DescriptionU" name="DescriptionU" cols="110" rows="10"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="LocationU">Location of Event</label>
                        <input type="text" class="form-control" id="LocationU" placeholder="Location of the event" name="LocationU" >
                    </div>

                    <div class="form-row" >
                        <div class="form-group col-md-2">
                            <img id ="savedImage" src=""  style="height: 100px">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="filesU">Images:</label>
                            <input type="file" id="filesU" onchange="showImage(event)" name="filesU"  class="form-control">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="MaxGuestU">Maximum Number of Guest</label>
                            <input type="number" class="form-control" id="MaxGuestU" name="MaxGuestU">
                        </div>
                        <div class="form-group col-md-3">
                            <label for="PricePerGuestU">Per person Cost</label>
                            <input type="number" class="form-control" id="PricePerGuestU" name="PricePerGuestU" >
                        </div>
                        <input id="IdHidden1" type="hidden" name="IdHidden1">
                    </div>
                    <button type="submit" class="btn btn-primary" style="margin-bottom: 10px">Update</button>
                </form>
            </div>
        </div>
        <div class="tab-pane" id="enquiry" role="tabpanel" aria-labelledby="messages-tab">
            <div class="container">
                <h3>Enquiries</h3>
                <br>
                <table id = "prvEnq" border="2px">
                    <tr>
                        <th>Serial No.</th>
                        <th>Customer ID</th>
                        <th>Subject</th>
                        <th>Enquiry</th>
                        <th>Status</th>
                        <th>Answer</th>
                        <th></th>
                    </tr>
                </table>
            </div>
            <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalCenterTitle">Reply</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form method="post" action="/enqReplyAdmin" >
                                <label for="enqAns">Reply</label>
                                <br>
                                <textarea id="enqAns" cols="63" rows="10" name="enqAns"></textarea>
                                <input type="hidden" id = "HiddenIdReply" name="HiddenIdReply">
                                <hr>
                                <button type="submit" class="btn btn-secondary" >Send</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="tab-pane" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            <div  id = "profileInfo">
                <div class="row">
                    <form style=" margin-top: 5%; border-radius: 20px" class="container" action="/updateAdminInfo" method="post">
                        <div class="form-row" >
                            <div class="form-group col-md-6">
                                <label for="fName">First Name</label>
                                <input type="text" class="form-control" id="fNameAdmin" placeholder="First Name" name="fname">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="lName">Last Name</label>
                                <input type="text" class="form-control" id="lNameAdmin" placeholder="Last Name" name="lname">
                            </div>
                        </div>
                        <div class="form-row" >
                            <div class="form-group col-md-4">
                                <label for="dob">Date of Birth</label>
                                <input type="date" class="form-control" id="dobAdmin" placeholder="dd-mm-yyyy" name="dob">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="age">Age</label>
                                <input type="number" class="form-control" id="ageAdmin" placeholder="Age" name="age">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="gender">Gender</label>
                                <br>
                                <select name="genderSelect" id="genderAdmin" class="form-control" >
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>

                                </select>
                            </div>
                        </div>
                        <div class="form-row" >
                            <div class="form-group col-md-6">
                                <label for="inputEmail4">Email</label>
                                <input type="email" class="form-control" id="inputEmail4Admin" placeholder="Email" name="email" >
                            </div>
                            <div class="form-group col-md-6">
                                <label for="inputPassword4">Password</label>
                                <input type="password" class="form-control" id="inputPassword4Admin" placeholder="Password" name="password">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputAddress">Address</label>
                            <input type="text" class="form-control" id="inputAddressAdmin" placeholder="1234 Main St" name="address">
                        </div>
                        <input type="hidden" id="HiddenId" name="idHidden">
                        <button type="submit" class="btn btn-primary" style="margin-bottom: 10px">Update</button>
                    </form>
                </div>
            </div>

        </div>
        <div class="tab-pane" id="carousel" role="tabpanel" aria-labelledby="carousel-tab">

            <form method="post" id="CarouselForm" >
            <table border="2px" id="CarouselTable">
                <tr>
                <th></th>
                <th>Slide Number</th>
                <th>Image</th>
                </tr>
            </table>
                <br>
                <button class="btn btn-info"  formmethod="post" formaction="/updateCaro" type="submit" disabled id="updCarouselBtn" onclick="onshowCaro()" >Update</button>
            </form>
            <hr>

            <div class="container" id="updateCarousel" style="display: none">
                <form action="/updateCarolShow" method="post"  enctype="multipart/form-data">
                <div class="form-group col-md-6">
                    <label for="SlideNo">Slide No</label>
                    <input type="text" id="SlideNo" name="SlideNo" class="form-control">
                </div>
                <div class="form-row" style="margin:0 0 16px">
                    <div class="form-group col-md-2">
                        <img id ="CarouselImage" src=""  style="height: 100px ; " class="form-control" >
                    </div>
                    <div class="form-group col-md-4">
                    <label for="CaroImage">Images</label>
                    <input type="file" id="CaroImage" name="CaroImage" onchange="showCaroAddImage(event)" class="form-control">
                        <input type="hidden" id="IdHidden2" name="IdHidden2">
                    </div>
                </div>

                <button class="btn btn-success" type="submit" style="align-content: center">Update</button>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="adminFuncs.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script>


    function delData() {

        var x = document.getElementsByClassName('selector')
        var count = 0;
        for (var i = 0; i < x.length; ++i) {
            if (x[i].checked) {
                count++;
            }
        }
        console.log(count)
        if (count>0) {
            document.getElementById('delBtn').disabled = false;
        }
        else
            document.getElementById('delBtn').disabled = true;
    }

    function UpdateData(){
        var x = document.getElementsByClassName('selector')
        var count = 0;
        for (var i = 0; i < x.length; ++i) {
            if (x[i].checked) {
                count++;
            }
        }
        console.log(count)
        if (count === 1) {
            document.getElementById('updBtn').disabled = false;
        }
        else
            document.getElementById('updBtn').disabled = true;
    }

    function bothOps() {
        delData();
        UpdateData()
    }
    var selectedBtn
    $(function() {
        $('button').click(function() { selectedBtn = this.id });
    });

        const $form1 = $('#EventForm')
        $form1.on('submit', submitHandler1)
        function submitHandler1 (e) {
            var data = {}
            var deldata = []
            var x = document.getElementsByClassName('EventSelector')
            var count = 0;
            for (var i = 0; i < x.length; ++i) {
                if (x[i].checked) {
                    data.val = x[i].id
                    deldata.push(x[i].id)
                }
            }
            var sendData = JSON.stringify(data);
            var sendDelData = JSON.stringify(deldata)
            e.preventDefault()
            if (selectedBtn == 'updEventBtn') {
                $.ajax({
                    url: '/updateEvent',
                    type: 'post',
                    contentType: 'application/json',
                    data: sendData
                }).done(response => {
                    document.getElementById('savedImage').src=response.array[0].Images
                    document.getElementById('EventNameU').value = response.array[0].EventName
                    document.getElementById('PricePerGuestU').value = response.array[0].PricePerGuest
                    document.getElementById('LocationU').value = response.array[0].Location
                    document.getElementById('MaxGuestU').value = response.array[0].MaxGuest
                    document.getElementById('IdHidden1').value = response.array[0]._id
                    document.getElementById('DescriptionU').value = response.array[0].Description


                })
            }
            else{
                $.ajax({
                    url: '/delEvent',
                    type: 'post',
                    contentType: 'application/json',
                    data: sendDelData
            }).done(response =>{

                window.location.href = response.role
            })
            }

        }


    function delEventData() {
            var x = document.getElementsByClassName('EventSelector')
            var count = 0;
            for (var i = 0; i < x.length; ++i) {
                if (x[i].checked) {
                    count++;
                }
            }
            console.log(count)
            if (count>0) {
                document.getElementById('delEventBtn').disabled = false;
            }
            else
                document.getElementById('delEventBtn').disabled = true;
        }

    function UpdateEventData(){
        var x = document.getElementsByClassName('EventSelector')
        var count = 0;
        for (var i = 0; i < x.length; ++i) {
            if (x[i].checked) {
                count++;
            }
        }
        console.log(count)
        if (count === 1) {
            document.getElementById('updEventBtn').disabled = false;
        }
        else
            document.getElementById('updEventBtn').disabled = true;
    }
    function bothEventOps() {
            UpdateEventData()
            delEventData()

    }


    const $form = $('#EMform')
    $form.on('submit', submitHandler)
    function submitHandler (e) {
        var data = {}
        var deldata = []
        var x = document.getElementsByClassName('selector')
        var count = 0;
        for (var i = 0; i < x.length; ++i) {
            if (x[i].checked) {
                data.val = x[i].id
                deldata.push(x[i].id)
            }
        }
        var sendData = JSON.stringify(data);
        var sendDelData = JSON.stringify(deldata)
        e.preventDefault()
        if (selectedBtn == 'updBtn') {
            $.ajax({
                url: '/updateEM',
                type: 'post',
                contentType: 'application/json',
                data: sendData
            }).done(response => {

                document.getElementById('fNameU').value = response.array[0].FirstName
                document.getElementById('lNameU').value = response.array[0].LastName
                document.getElementById('dobU').value = response.array[0].DOB
                document.getElementById('ageU').value = response.array[0].Age
                document.getElementById('genderU').value = (response.array[0].Gender).toLowerCase()
                document.getElementById('inputEmail4U').value = response.array[0].Email
                document.getElementById('inputPassword4U').value = response.array[0].Password
                document.getElementById('inputAddressU').value = response.array[0].Address
                document.getElementById('IdHidden').value = response.array[0]._id


            })
        }
        else{
            $.ajax({
                url: '/delEM',
                type: 'post',
                contentType: 'application/json',
                data: sendDelData
            }).done(response =>{

                window.location.href = response.role
            })
        }

    }


    function UpdateCaroData(){
        var x = document.getElementsByClassName('CarouselSelector')
        var count = 0;
        for (var i = 0; i < x.length; ++i) {
            if (x[i].checked) {
                count++;
            }
        }
        console.log(count)
        if (count === 1) {
            document.getElementById('updCarouselBtn').disabled = false;
        }
        else
            document.getElementById('updCarouselBtn').disabled = true;
    }

    function bothCaroOps() {

        UpdateCaroData()
    }


    const $form2 = $('#CarouselForm')
    $form2.on('submit', submitHandler2)
    function submitHandler2 (e) {
        var data = {}
        var deldata = []
        var x = document.getElementsByClassName('CarouselSelector')
        var count = 0;
        for (var i = 0; i < x.length; ++i) {
            if (x[i].checked) {
                data.val = x[i].id
                deldata.push(x[i].id)
            }
        }
        var sendData = JSON.stringify(data);
        var sendDelData = JSON.stringify(deldata)
        e.preventDefault()
        if (selectedBtn == 'updCarouselBtn') {
            $.ajax({
                url: '/updateCaro',
                type: 'post',
                contentType: 'application/json',
                data: sendData
            }).done(response => {
                document.getElementById('CarouselImage').src=response.array[0].Images
                document.getElementById('SlideNo').value = response.array[0].SlideNo
                document.getElementById('IdHidden2').value = response.array[0]._id
            })
        }


    }



    function showImage(event) {
        var input = event.target;
        var reader = new FileReader();
        reader.onload = function() {
            var dataURL = reader.result;
            var output = document.getElementById("savedImage");
            output.src = dataURL;
        };
        reader.readAsDataURL(input.files[0]);
    }
    function showCaroAddImage(event) {
        var input = event.target;
        var reader = new FileReader();
        reader.onload = function() {
            var dataURL = reader.result;
            var output = document.getElementById("CarouselImage");
            output.src = dataURL;
        };
        reader.readAsDataURL(input.files[0]);
    }
    function onshowCaro() {
        document.getElementById('updateCarousel').style.display = "block"
    }

</script>
</body>
</html>
